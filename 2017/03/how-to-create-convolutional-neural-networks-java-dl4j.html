<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">        

    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeEclipse.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreEclipse.min.css">

    <link href="/css/custom.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>How to Create Convolutional Neural Networks Using Java and DL4J - Progur!</title>
<meta property="og:title" content="How to Create Convolutional Neural Networks Using Java and DL4J" />
<meta name="description" content="In this tutorial, you’ll learn how to use Java and DeepLearning4J(DL4J) to create a convolutional neural network that can classify CIFAR-10 images." />
<meta property="og:description" content="In this tutorial, you’ll learn how to use Java and DeepLearning4J(DL4J) to create a convolutional neural network that can classify CIFAR-10 images." />
<link rel="canonical" href="http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html" />
<meta property="og:url" content="http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html" />
<meta property="og:site_name" content="Progur!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-03-10T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@hathibel" />
<meta name="twitter:creator" content="@hathibel" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "How to Create Convolutional Neural Networks Using Java and DL4J",
    "datePublished": "2017-03-10T00:00:00+05:30",
    "description": "In this tutorial, you’ll learn how to use Java and DeepLearning4J(DL4J) to create a convolutional neural network that can classify CIFAR-10 images.",
    "logo": "http://progur.com/assets/logo.jpg",
    "url": "http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html"
  }
</script>
<!-- End Jekyll SEO tag -->
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><i class="fa fa-terminal logo"></i> PROGUR!</a>
        </div>
        <!-- Options -->
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a target="_blank" href="https://twitter.com/hathibel" title="Follow me on Twitter"><i class="fa fa-lg fa-twitter" style="color: #4099FF"></i> &nbsp; Twitter</a></li>
            <li><a target="_blank" href="https://plus.google.com/+Progur" title="Follow me on Google+" ><i class="fa fa-lg fa-google-plus" style="color: #d34836"></i> &nbsp; Google+</a></li>
            <li><a target="_blank" href="https://github.com/hathibelagal" title="Follow me on GitHub"><i class="fa fa-lg fa-github" style="color: #999999"></i> &nbsp; GitHub</a></li>
            <li><a target="_blank" href="https://medium.com/@hathibel" title="Follow me on Medium"><i class="fa fa-lg fa-medium" style="color: #0be370"></i> &nbsp; Medium</a></li>
            <li><a target="_blank" href="/feed.xml" title="Subscribe to our RSS feed"><i class="fa fa-lg fa-rss" style="color: #FF6600"></i>&nbsp; RSS</a></li>
          </ul>
        </div>
        <!-- End of Options -->
      </div>
    </nav>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div>
                <div>
                    <h1 class="post-title">How to Create Convolutional Neural Networks Using Java and DL4J</h1>
                    <div class="post-meta">Written by Ashraff Hathibelagal &bull; 10 March 2017</div>
                    <p style="margin-bottom: 20px"><span class="label label-info"><i class="fa fa-tag"> </i> &nbsp; Programming </span></p>
                    <div class="post-actual-content">
                        <p>Using <a href="https://github.com/deeplearning4j/deeplearning4j" target="_blank" rel="nofollow">Deeplearning4J</a>, you can create convolutional neural networks, also referred to as CNNs or ConvNets, in just a few lines of code. If you don’t know what a CNN is, for now, just think of it as a feed-forward neural network that is optimized for tasks such as image classification and natural language processing.</p>

<p>In this short tutorial, I’m going to show you how to create a simple CNN and train it using the CIFAR-10 dataset, a very popular dataset that has thousands of labeled images.</p>

<h3 id="prerequisites">Prerequisites</h3>

<p>To follow along, you’ll need:</p>

<ul>
  <li>The latest version of IntelliJ IDEA</li>
  <li>Java 8</li>
</ul>

<h3 id="project-setup">1. Project Setup</h3>

<p>Fire up IntelliJ IDEA and create a new Maven project using the <code class="highlighter-rouge">quickstart</code> archetype. Once the project has been generated, open the <strong>pom.xml</strong> file and add the following inside the <code class="highlighter-rouge">&lt;dependencies&gt;</code> tag:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.deeplearning4j<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>deeplearning4j-core<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.7.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.nd4j<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>nd4j-native-platform<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.7.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<p>As you can see, we’ll be using DL4J 0.7.2 in this tutorial.</p>

<p>At this point, the project setup is complete.</p>

<h3 id="create-an-iterator">2. Create an Iterator</h3>

<p>You don’t have to manually download the CIFAR-10 dataset for this tutorial. Instead you can use a class called <code class="highlighter-rouge">CifarDataSetIterator</code>, which automatically downloads the dataset using the <a href="https://github.com/deeplearning4j/DataVec" target="_blank" rel="nofollow">DataVec</a> library. So, inside the <code class="highlighter-rouge">main()</code> function of the <strong>App.java</strong> file, add the following code:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">CifarDataSetIterator</span> <span class="n">dataSetIterator</span> <span class="o">=</span> 
                <span class="k">new</span> <span class="nf">CifarDataSetIterator</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">5000</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span></code></pre></figure>

<p>Note that, for now, we are using only 5000 images from the dataset. Feel free to change that number.</p>

<p>If you want to list all the labels present in the dataset, you can use the following code:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dataSetIterator</span><span class="o">.</span><span class="na">getLabels</span><span class="o">());</span></code></pre></figure>

<p>At this point, if you compile and run your project, you should see the following output:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>airplane, automobile, bird, cat, deer, dog, frog, horse, ship, truck, <span class="o">]</span></code></pre></figure>

<h3 id="create-the-neural-network">3. Create the Neural Network</h3>

<p>It’s now time to start creating the individual layers of our neural network. We’re going to have the following layers:</p>

<ul>
  <li>Three convolution layers</li>
  <li>Three subsampling layers</li>
  <li>One output layer</li>
</ul>

<p>We’re going to order the layers such that each convolution layer is immediately followed by a subsampling layer. The output layer will, of course, be the last layer and it will have 10 neurons, to represent the 10 labels of our dataset.</p>

<p>Accordingly, add the following code to your file:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ConvolutionLayer</span> <span class="n">layer0</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConvolutionLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
        <span class="o">.</span><span class="na">nIn</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
        <span class="o">.</span><span class="na">nOut</span><span class="o">(</span><span class="mi">16</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stride</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">padding</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">weightInit</span><span class="o">(</span><span class="n">WeightInit</span><span class="o">.</span><span class="na">XAVIER</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"First convolution layer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">activation</span><span class="o">(</span><span class="n">Activation</span><span class="o">.</span><span class="na">RELU</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">SubsamplingLayer</span> <span class="n">layer1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubsamplingLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">SubsamplingLayer</span><span class="o">.</span><span class="na">PoolingType</span><span class="o">.</span><span class="na">MAX</span><span class="o">)</span>
        <span class="o">.</span><span class="na">kernelSize</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stride</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"First subsampling layer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">ConvolutionLayer</span> <span class="n">layer2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConvolutionLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
        <span class="o">.</span><span class="na">nOut</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stride</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">padding</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">weightInit</span><span class="o">(</span><span class="n">WeightInit</span><span class="o">.</span><span class="na">XAVIER</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Second convolution layer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">activation</span><span class="o">(</span><span class="n">Activation</span><span class="o">.</span><span class="na">RELU</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">SubsamplingLayer</span> <span class="n">layer3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubsamplingLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">SubsamplingLayer</span><span class="o">.</span><span class="na">PoolingType</span><span class="o">.</span><span class="na">MAX</span><span class="o">)</span>
        <span class="o">.</span><span class="na">kernelSize</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stride</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Second subsampling layer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">ConvolutionLayer</span> <span class="n">layer4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConvolutionLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
        <span class="o">.</span><span class="na">nOut</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stride</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">padding</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">weightInit</span><span class="o">(</span><span class="n">WeightInit</span><span class="o">.</span><span class="na">XAVIER</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Third convolution layer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">activation</span><span class="o">(</span><span class="n">Activation</span><span class="o">.</span><span class="na">RELU</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">SubsamplingLayer</span> <span class="n">layer5</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubsamplingLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">SubsamplingLayer</span><span class="o">.</span><span class="na">PoolingType</span><span class="o">.</span><span class="na">MAX</span><span class="o">)</span>
        <span class="o">.</span><span class="na">kernelSize</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">stride</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Third subsampling layer"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">OutputLayer</span> <span class="n">layer6</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OutputLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">LossFunctions</span><span class="o">.</span><span class="na">LossFunction</span><span class="o">.</span><span class="na">NEGATIVELOGLIKELIHOOD</span><span class="o">)</span>
        <span class="o">.</span><span class="na">activation</span><span class="o">(</span><span class="n">Activation</span><span class="o">.</span><span class="na">SOFTMAX</span><span class="o">)</span>
        <span class="o">.</span><span class="na">weightInit</span><span class="o">(</span><span class="n">WeightInit</span><span class="o">.</span><span class="na">XAVIER</span><span class="o">)</span>
        <span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="s">"Output"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">nOut</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre></figure>

<p>Note that you are free to choose other values for the kernel sizes, the strides, and the paddings. But, I suggest you use <code class="highlighter-rouge">RELU</code> as the activation function for all the convolution layers, and <code class="highlighter-rouge">SOFTMAX</code> for the output layer. As for the subsampling layers, <code class="highlighter-rouge">MAX</code> is the most often used pooling type.</p>

<p>Also make sure you always pass <code class="highlighter-rouge">3</code> to the first convolution layer’s <code class="highlighter-rouge">nIn()</code> method. This is important because all our input images have 3 channels.</p>

<p>We must now create a <code class="highlighter-rouge">MultiLayerConfiguration</code> object specifying the configuration details of our neural network. Using it, we can also arrange our layers in the correct order.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">MultiLayerConfiguration</span> <span class="n">configuration</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NeuralNetConfiguration</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">seed</span><span class="o">(</span><span class="mi">12345</span><span class="o">)</span>
        <span class="o">.</span><span class="na">iterations</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">optimizationAlgo</span><span class="o">(</span><span class="n">OptimizationAlgorithm</span><span class="o">.</span><span class="na">STOCHASTIC_GRADIENT_DESCENT</span><span class="o">)</span>
        <span class="o">.</span><span class="na">learningRate</span><span class="o">(</span><span class="mf">0.001</span><span class="o">)</span>
        <span class="o">.</span><span class="na">regularization</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
        <span class="o">.</span><span class="na">l2</span><span class="o">(</span><span class="mf">0.0004</span><span class="o">)</span>
        <span class="o">.</span><span class="na">updater</span><span class="o">(</span><span class="n">Updater</span><span class="o">.</span><span class="na">NESTEROVS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">momentum</span><span class="o">(</span><span class="mf">0.9</span><span class="o">)</span>
        <span class="o">.</span><span class="na">list</span><span class="o">()</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">layer0</span><span class="o">)</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">layer1</span><span class="o">)</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">layer2</span><span class="o">)</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">layer3</span><span class="o">)</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">layer4</span><span class="o">)</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">layer5</span><span class="o">)</span>
            <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="n">layer6</span><span class="o">)</span>
        <span class="o">.</span><span class="na">pretrain</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
        <span class="o">.</span><span class="na">backprop</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setInputType</span><span class="o">(</span><span class="n">InputType</span><span class="o">.</span><span class="na">convolutional</span><span class="o">(</span><span class="mi">32</span><span class="o">,</span><span class="mi">32</span><span class="o">,</span><span class="mi">3</span><span class="o">))</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre></figure>

<p>Note that you are again free to experiment with different values for the learning rate, l2, momentum, and optimization algorithms. Another important thing to note in the above code is the call to the <code class="highlighter-rouge">setInputType()</code> method, which specifies that our neural network’s input type is convolutional, with 32x32 images having 3 colors.</p>

<p>Finally, you can create the neural network by passing the <code class="highlighter-rouge">configuration</code> object to the constructor of the <code class="highlighter-rouge">MultiLayerNetwork</code> class. Once created, the network must be initialized by calling its <code class="highlighter-rouge">init()</code> method.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">MultiLayerNetwork</span> <span class="n">network</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MultiLayerNetwork</span><span class="o">(</span><span class="n">configuration</span><span class="o">);</span>
<span class="n">network</span><span class="o">.</span><span class="na">init</span><span class="o">();</span></code></pre></figure>

<h3 id="train-and-evaluate-the-neural-network">4. Train and Evaluate the Neural Network</h3>

<p>To start training the convolutional neural network you just created, just call its <code class="highlighter-rouge">fit()</code> method and pass the iterator object to it.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">network</span><span class="o">.</span><span class="na">fit</span><span class="o">(</span><span class="n">dataSetIterator</span><span class="o">);</span></code></pre></figure>

<p>Once the training is complete, you can evaluate your network by calling its <code class="highlighter-rouge">evaluate()</code> method. I suggest you pass a new <code class="highlighter-rouge">CifarDataSetIterator</code> object to it, this time using the test data only. The method returns an <code class="highlighter-rouge">Evaluation</code> object. By calling its <code class="highlighter-rouge">stats()</code> method, you can get a detailed report of your network’s performance:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Evaluation</span> <span class="n">evaluation</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="na">evaluate</span><span class="o">(</span><span class="k">new</span> <span class="n">CifarDataSetIterator</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">500</span><span class="o">,</span> <span class="kc">false</span><span class="o">));</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">evaluation</span><span class="o">.</span><span class="na">stats</span><span class="o">());</span></code></pre></figure>

<p>Go ahead and run the project now. You’ll, of course, have to wait for several minutes for the training to complete.</p>

<h3 id="conclusion">Conclusion</h3>

<p>After tinkering with the network’s parameters for about an hour or so, I’ve managed to achieve an accuracy of about 60%. If you put in more effort, and are patient enough for longer training durations, I’m sure you can achieve much higher accuracies. The best convnets out there have achieved almost 95% accuracy.</p>

<h4 id="related-reading">Related Reading</h4>

<ul>
  <li><a href="/2017/01/how-to-use-deeplearning4j-on-android.html">How to Use Deeplearning4J in Android Apps</a></li>
  <li><a href="/2016/09/how-to-create-and-use-neural-networks-in-javascript.html">How to Create Simple Neural Networks in JavaScript</a></li>
  <li><a href="/2016/09/how-to-create-deep-neural-networks-in-javascript.html">How to Create Deep Neural Networks in JavaScript</a></li>
</ul>

                    </div>

                    <!-- Affiliate links -->
                    <div class="post-affiliates">
                        <script type="text/javascript">
                        amzn_assoc_placement = "adunit0";
                        amzn_assoc_search_bar = "true";
                        amzn_assoc_tracking_id = "progur-20";
                        amzn_assoc_ad_mode = "manual";
                        amzn_assoc_ad_type = "smart";
                        amzn_assoc_marketplace = "amazon";
                        amzn_assoc_region = "US";
                        amzn_assoc_title = "Shop Related Products";
                        amzn_assoc_linkid = "6b7650e384633c5d230f7dd85c971ee5";
                        amzn_assoc_asins = "B071VLZ9ZK,B01J6G4WB6,B00C893P8U,B00P8DRZWA,B01MRZFBBH,B01MXLZIDS,B01H3V07EW,B00LEAPLWW";
                        </script>
                        <script src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US"></script>
                    </div>
                    <!-- End of affiliate links -->

                    <!-- Share -->
                    <div class="post-share">
                        <p>If you found this article useful, please share it with your friends and colleagues!</p>
                        <a class="btn btn-primary" style="background:#4099FF" target="_blank" href="https://twitter.com/intent/tweet?text=How to Create Convolutional Neural Networks Using Java and DL4J&url=http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html&via=hathibel" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-twitter fa-lg"></i></a>

                        <a class="btn btn-primary" style="background:#3b5998" target="_blank" href="https://facebook.com/sharer.php?u=http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-facebook fa-lg"></i></a>
                        
                        <a class="btn btn-primary" style="background:#dd4b39" target="_blank" href="https://plus.google.com/share?url=http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i class="fa fa-google-plus fa-lg"></i></a>
                    </div>

                    <!-- End of Share -->

                    <!-- Comments -->
                      <div class="comments">
                          <div id="disqus_thread"></div>
                            <script>                                    
                                var disqus_config = function () {
                                    this.page.url = "http://progur.com/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html";
                                    this.page.identifier = "/2017/03/how-to-create-convolutional-neural-networks-java-dl4j.html";
                                };
                                (function() {
                                    var d = document, s = d.createElement('script');

                                    s.src = '//progur.disqus.com/embed.js';

                                    s.setAttribute('data-timestamp', +new Date());
                                    (d.head || d.body).appendChild(s);
                                })();
                            </script>
                            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                      </div>
                    <!-- End of comments -->
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="footer">
  <div class="container">
    <p>
        Copyright &copy; 2016-2017 Progur.com | All rights reserved.
        <br/>
        Powered by Jekyll, and several secret sauces.
        <br/>
        <i>We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</i>
    </p>
  </div>
</footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shAutoloader.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushBash.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJava.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPython.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushRuby.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCpp.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.min.js"></script>

          <script>
              SyntaxHighlighter.defaults.toolbar = false;
              SyntaxHighlighter.all();
          </script>

        <!-- Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-46644689-5', 'auto');
          ga('send', 'pageview');

        </script>
        <!-- End of Analytics -->

  </body>
</html>

