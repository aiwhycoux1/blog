<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">        

    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeEclipse.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreEclipse.min.css">

    <link href="/css/custom.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Getting Started With Firebase JobDispatcher for Android - Progur!</title>
<meta property="og:title" content="Getting Started With Firebase JobDispatcher for Android" />
<meta name="description" content="In this tutorial, I’ll show you how to schedule jobs on Android using a library called Firebase JobDispatcher." />
<meta property="og:description" content="In this tutorial, I’ll show you how to schedule jobs on Android using a library called Firebase JobDispatcher." />
<link rel="canonical" href="http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html" />
<meta property="og:url" content="http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html" />
<meta property="og:site_name" content="Progur!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-03T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@hathibel" />
<meta name="twitter:creator" content="@hathibel" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Getting Started With Firebase JobDispatcher for Android",
    "datePublished": "2017-01-03T00:00:00+05:30",
    "description": "In this tutorial, I’ll show you how to schedule jobs on Android using a library called Firebase JobDispatcher.",
    "logo": "http://progur.com/assets/logo.jpg",
    "url": "http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html"
  }
</script>
<!-- End Jekyll SEO tag -->
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><i class="fa fa-terminal logo"></i> PROGUR!</a>
        </div>
        <!-- Options -->
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a target="_blank" href="https://twitter.com/hathibel" title="Follow me on Twitter"><i class="fa fa-lg fa-twitter" style="color: #4099FF"></i> &nbsp; Twitter</a></li>
            <li><a target="_blank" href="https://plus.google.com/+Progur" title="Follow me on Google+" ><i class="fa fa-lg fa-google-plus" style="color: #d34836"></i> &nbsp; Google+</a></li>
            <li><a target="_blank" href="https://github.com/hathibelagal" title="Follow me on GitHub"><i class="fa fa-lg fa-github" style="color: #999999"></i> &nbsp; GitHub</a></li>
            <li><a target="_blank" href="https://medium.com/@hathibel" title="Follow me on Medium"><i class="fa fa-lg fa-medium" style="color: #0be370"></i> &nbsp; Medium</a></li>
            <li><a target="_blank" href="/feed.xml" title="Subscribe to our RSS feed"><i class="fa fa-lg fa-rss" style="color: #FF6600"></i>&nbsp; RSS</a></li>
          </ul>
        </div>
        <!-- End of Options -->
      </div>
    </nav>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div>
                <div>
                    <h1 class="post-title">Getting Started With Firebase JobDispatcher for Android</h1>
                    <div class="post-meta">Written by Ashraff Hathibelagal &bull; 03 January 2017</div>
                    <p style="margin-bottom: 20px"><span class="label label-info"><i class="fa fa-tag"> </i> &nbsp; Programming </span></p>
                    <div class="post-banner-ad">
                        <iframe src="//rcm-na.amazon-adsystem.com/e/cm?o=1&p=12&l=ur1&category=audible&banner=1C5G327FPA4S79WQ9Z82&f=ifr&lc=pf4&linkID=5cd4e8791cde1b1533ed492ce1c14119&t=progur-20&tracking_id=progur-20" width="300" height="250" scrolling="no" border="0" marginwidth="0" style="border:none;" frameborder="0"></iframe>
                    </div>
                    <div class="post-actual-content">
                        <p>On devices that run Android 5.0 or higher, developers can easily schedule jobs using the JobScheduler system service. To support the same functionality on older versions of Android, Google’s recently released a library called <a href="https://github.com/firebase/firebase-jobdispatcher-android" target="_blank" rel="nofollow">Firebase JobDispatcher</a>. In this tutorial, I’ll be showing you how to use the library to schedule simple recurring jobs.</p>

<h3 id="prerequisites">Prerequisites</h3>

<p>To be able to follow this tutorial, all you need is a recent version of Android Studio. Additionally, your project must support API levels 9 or higher.</p>

<h3 id="add-dependencies">Add Dependencies</h3>

<p>To add Firebase JobDispatcher to your project, add the following <code class="highlighter-rouge">compile</code> dependency to your app module’s <strong>build.gradle</strong> file:</p>

<figure class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="n">compile</span> <span class="s1">'com.firebase:firebase-jobdispatcher:0.5.2'</span></code></pre></figure>

<p>And then, press <strong>Sync Now</strong> to update the project.</p>

<h3 id="defining-a-job">Defining a Job</h3>

<p>To define a new job, you must create a new Java class that is a subclass of the <code class="highlighter-rouge">JobService</code> class. In this tutorial, we’ll be creating a recurring job that simply logs the amount of free space available on an Android device. Let’s name the class <strong>DeviceSpaceService</strong>.</p>

<p>Because <code class="highlighter-rouge">JobService</code> is an abstract class, Android Studio should prompt you to override all its abstract methods.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">com.firebase.jobdispatcher.JobParameters</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.firebase.jobdispatcher.JobService</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeviceSpaceService</span> <span class="kd">extends</span> <span class="n">JobService</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onStartJob</span><span class="o">(</span><span class="n">JobParameters</span> <span class="n">job</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// More code goes here</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onStopJob</span><span class="o">(</span><span class="n">JobParameters</span> <span class="n">job</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>As you might have guessed, we’ll be doing most of the work inside the <code class="highlighter-rouge">onStartJob()</code> method.</p>

<p>To fetch the disk space available on an Android device, you can use an instance of the <code class="highlighter-rouge">StatFs</code> class. Make sure that you initialize it with the root directory. Once you’ve created the instance, simply call the <code class="highlighter-rouge">getAvailableBlocksLong()</code> method to fetch the free space available.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">StatFs</span> <span class="n">statFs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StatFs</span><span class="o">(</span><span class="n">Environment</span><span class="o">.</span><span class="na">getRootDirectory</span><span class="o">().</span><span class="na">getPath</span><span class="o">());</span>

<span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">"MY DEVICE SPACE SERVICE"</span><span class="o">,</span>
        <span class="s">"Free space is "</span> <span class="o">+</span>
                <span class="o">(</span><span class="n">statFs</span><span class="o">.</span><span class="na">getAvailableBlocksLong</span><span class="o">()</span> <span class="o">*</span>
                 <span class="n">statFs</span><span class="o">.</span><span class="na">getBlockSizeLong</span><span class="o">()</span> <span class="o">/</span>
                 <span class="mi">1024</span><span class="o">)</span> <span class="o">+</span>
                <span class="s">" Kb"</span>
<span class="o">);</span></code></pre></figure>

<p>Like all services, this service too must be declared in the project’s manifest. Additionally, all <code class="highlighter-rouge">JobService</code> services must have an intent filter for the action <code class="highlighter-rouge">com.firebase.jobdispatcher.ACTION_EXECUTE</code>. For the sake of security, it’s a good idea to set the <code class="highlighter-rouge">exported</code> attribute of the service to <code class="highlighter-rouge">false</code>.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">".DeviceSpaceService"</span>
    <span class="na">android:exported=</span><span class="s">"false"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.firebase.jobdispatcher.ACTION_EXECUTE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span></code></pre></figure>

<p>At this point, we’ve finished defining the job. So, let’s move on to actually scheduling it.</p>

<h3 id="scheduling-a-job">Scheduling a Job</h3>

<p>To schedule a job, you must first create a <code class="highlighter-rouge">FirebaseJobDispatcher</code> object. Therefore, add the following code anywhere inside your activity. Usually, the <code class="highlighter-rouge">onCreate()</code> method of an activity is a good place for it.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">FirebaseJobDispatcher</span> <span class="n">dispatcher</span> <span class="o">=</span>
       <span class="k">new</span> <span class="nf">FirebaseJobDispatcher</span><span class="o">(</span>
            <span class="k">new</span> <span class="nf">GooglePlayDriver</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">)</span>
       <span class="o">);</span></code></pre></figure>

<p>As you can see, the constructor of the dispatcher expects a <code class="highlighter-rouge">GooglePlayDriver</code> object, which can be created using the activity’s context.</p>

<p>You can now call either the <code class="highlighter-rouge">schedule()</code> method or the <code class="highlighter-rouge">mustSchedule()</code> method to schedule your job. The only difference between the two is that <code class="highlighter-rouge">mustSchedule()</code> requires less error checking. As an argument, both the methods expect a <code class="highlighter-rouge">Job</code> instance, which can be created using the <code class="highlighter-rouge">newJobBuilder()</code> method. While creating the <code class="highlighter-rouge">Job</code> instance, you must specify the subclass of the <code class="highlighter-rouge">JobService</code> you created and a tag. You can also tell if your job must occur again and again. Here’s how:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">dispatcher</span><span class="o">.</span><span class="na">mustSchedule</span><span class="o">(</span>
    <span class="n">dispatcher</span><span class="o">.</span><span class="na">newJobBuilder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setService</span><span class="o">(</span><span class="n">DeviceSpaceService</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setTag</span><span class="o">(</span><span class="s">"DeviceSpaceService"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setRecurring</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setTrigger</span><span class="o">(</span><span class="n">Trigger</span><span class="o">.</span><span class="na">executionWindow</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">30</span><span class="o">))</span>
        <span class="o">.</span><span class="na">build</span><span class="o">()</span>
<span class="o">);</span></code></pre></figure>

<p>In the above code, you can see that we have specified an execution window of 5 to 30 seconds. This is important because recurring jobs always need an execution window trigger. Of course, if your job is not recurring, you don’t have to set any trigger for it.</p>

<p>When the job is triggered, you will see output that looks like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>01-03 06:47:47 41/com.progur.firebasetutorial I/MY DEVICE SPACE SERVICE: Free space is 320844 Kb
</code></pre>
</div>

<p>The tag associated with a job is quite important because you would be using it while cancelling a job.</p>

<h3 id="conclusion">Conclusion</h3>

<p>You now know how to use Firebase JobDispatcher. It is a great way to schedule tasks consistently on almost all versions of Android. However, for it to work, the user’s device must have the Google Play Services app installed. That, of course, is something you don’t really have to worry about these days.</p>

<h4 id="related-reading">Related Reading</h4>

<ul>
  <li><a href="/2016/11/create-imgur-client-android.html">How to Create an Imgur Client for Android</a></li>
  <li><a href="/2016/10/how-to-use-reddit-oauth2-in-android-apps.html">How to Use Reddit OAuth 2.0 In Android Apps</a></li>
  <li><a href="/2016/12/display-gifs-webps-with-facebook-fresco.html">Displaying Large Images in Android Apps Using Facebook Fresco</a></li>
</ul>

                    </div>

                    <!-- Affiliate links -->
                    <div class="post-affiliates">
                        
                            <script src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=05bf80c0-f7ed-4826-9e55-1ee911da4f6c"></script>
                        
                    </div>
                    <!-- End of affiliate links -->

                    <!-- Share -->
                    <div class="post-share">
                        <p>If you found this article useful, please share it with your friends and colleagues!</p>
                        <a class="btn btn-primary" style="background:#4099FF" target="_blank" href="https://twitter.com/intent/tweet?text=Getting Started With Firebase JobDispatcher for Android&url=http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html&via=hathibel" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-twitter fa-lg"></i></a>

                        <a class="btn btn-primary" style="background:#3b5998" target="_blank" href="https://facebook.com/sharer.php?u=http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-facebook fa-lg"></i></a>
                        
                        <a class="btn btn-primary" style="background:#dd4b39" target="_blank" href="https://plus.google.com/share?url=http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i class="fa fa-google-plus fa-lg"></i></a>
                    </div>

                    <!-- End of Share -->

                    <!-- Comments -->
                      <div class="comments">
                          <div id="disqus_thread"></div>
                            <script>                                    
                                var disqus_config = function () {
                                    this.page.url = "http://progur.com/2017/01/get-started-with-firebase-jobdispatcher.html";
                                    this.page.identifier = "/2017/01/get-started-with-firebase-jobdispatcher.html";
                                };
                                (function() {
                                    var d = document, s = d.createElement('script');

                                    s.src = '//progur.disqus.com/embed.js';

                                    s.setAttribute('data-timestamp', +new Date());
                                    (d.head || d.body).appendChild(s);
                                })();
                            </script>
                            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                      </div>
                    <!-- End of comments -->
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="footer">
  <div class="container">
    <p>
        Copyright &copy; 2016-2017 Progur.com | All rights reserved.
        <br/>
        Powered by Jekyll, and several secret sauces.
        <br/>
        <i>We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</i>
    </p>
  </div>
</footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shAutoloader.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushBash.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJava.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPython.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushRuby.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCpp.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.min.js"></script>

          <script>
              SyntaxHighlighter.defaults.toolbar = false;
              SyntaxHighlighter.all();
          </script>

        <!-- Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-46644689-5', 'auto');
          ga('send', 'pageview');

        </script>
        <!-- End of Analytics -->

  </body>
</html>

