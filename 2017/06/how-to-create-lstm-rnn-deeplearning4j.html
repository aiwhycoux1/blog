<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">        

    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeEclipse.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreEclipse.min.css">

    <link href="/css/custom.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>How to Create an LSTM Recurrent Neural Network Using DL4J - Progur!</title>
<meta property="og:title" content="How to Create an LSTM Recurrent Neural Network Using DL4J" />
<meta name="description" content="In this tutorial, I’ll show you how to use DL4J to create an LSTM that can generate sentences that are similar to those written by the 19th century author Emma Leslie." />
<meta property="og:description" content="In this tutorial, I’ll show you how to use DL4J to create an LSTM that can generate sentences that are similar to those written by the 19th century author Emma Leslie." />
<link rel="canonical" href="http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html" />
<meta property="og:url" content="http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html" />
<meta property="og:site_name" content="Progur!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-13T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@hathibel" />
<meta name="twitter:creator" content="@hathibel" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "How to Create an LSTM Recurrent Neural Network Using DL4J",
    "datePublished": "2017-06-13T00:00:00+05:30",
    "description": "In this tutorial, I’ll show you how to use DL4J to create an LSTM that can generate sentences that are similar to those written by the 19th century author Emma Leslie.",
    "logo": "http://progur.com/assets/logo.jpg",
    "url": "http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html"
  }
</script>
<!-- End Jekyll SEO tag -->
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><i class="fa fa-terminal logo"></i> PROGUR!</a>
        </div>
        <!-- Options -->
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a target="_blank" href="https://twitter.com/hathibel" title="Follow me on Twitter"><i class="fa fa-lg fa-twitter" style="color: #4099FF"></i> &nbsp; Twitter</a></li>
            <li><a target="_blank" href="https://plus.google.com/+Progur" title="Follow me on Google+" ><i class="fa fa-lg fa-google-plus" style="color: #d34836"></i> &nbsp; Google+</a></li>
            <li><a target="_blank" href="https://github.com/hathibelagal" title="Follow me on GitHub"><i class="fa fa-lg fa-github" style="color: #999999"></i> &nbsp; GitHub</a></li>
            <li><a target="_blank" href="https://medium.com/@hathibel" title="Follow me on Medium"><i class="fa fa-lg fa-medium" style="color: #0be370"></i> &nbsp; Medium</a></li>
            <li><a target="_blank" href="/feed.xml" title="Subscribe to our RSS feed"><i class="fa fa-lg fa-rss" style="color: #FF6600"></i>&nbsp; RSS</a></li>
          </ul>
        </div>
        <!-- End of Options -->
      </div>
    </nav>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div>
                <div>
                    <h1 class="post-title">How to Create an LSTM Recurrent Neural Network Using DL4J</h1>
                    <div class="post-meta">Written by Ashraff Hathibelagal &bull; 13 June 2017</div>
                    <p style="margin-bottom: 20px"><span class="label label-info"><i class="fa fa-tag"> </i> &nbsp; Programming </span></p>
                    <div class="post-actual-content">
                        <p>Long short-term memory recurrent neural networks, or LSTM RNNs for short, are neural networks that can memorize and regurgitate sequential data. They’ve become very popular these days, primarly because they can be used to create bots that can generate articles, stories, music, poems, screenplays - you name it! How? Well, its because a lot of things humans do involve sequences.</p>

<p>To make things clearer, let me give you a few examples. An LSTM can be trained on a novel to generate sentences that look very similar to those present in the novel. If you train it with multiple novels written by the same author, the LSTM will start sounding like the author. Similarly, an LSTM trained using a collection of songs that belong to a specific genre of music will be able to generate <em>“songs”</em> that belong to the same genre. I hope you get the idea.</p>

<p>In this tutorial, I’ll show you how to use <a href="https://github.com/deeplearning4j/deeplearning4j" target="_blank" rel="nofollow">Deeplearning4J</a> to create an LSTM that can generate sentences that are similar to those written by the prolific 19th century author Emma Leslie. We’ll be using her novel <a href="http://www.gutenberg.org/ebooks/19136" target="_blank" rel="nofollow">Hayslope Grange</a> as our training data, so, before we begin, I suggest you download the novel as plain text and store it somewhere on your computer.</p>

<h3 id="read-the-novel">Read the Novel</h3>

<p>The first thing you need to do is, of course, convert the text of the novel into a string you can use in your program. The easiest way to do so is to use the <code class="highlighter-rouge">IOUtils.toString()</code> method, which is available in the Apache Commons IO library.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">inputData</span> <span class="o">=</span> <span class="n">IOUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"/tmp/hayslope_grange.txt"</span><span class="o">),</span> <span class="s">"UTF-8"</span><span class="o">);</span></code></pre></figure>

<p>You are free to use all the text that’s available in the novel. I, however, in order to speed things up, will be using only the first 50000 characters.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">inputData</span> <span class="o">=</span> <span class="n">inputData</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">50000</span><span class="o">);</span></code></pre></figure>

<h3 id="design-the-lstm-neural-network">Design the LSTM Neural Network</h3>

<p>Our neural network shall have an input LSTM layer, a hidden layer, and an output RNN layer. How many neurons should be present in these layers? Well, that depends on how many different characters your network can handle.</p>

<p>For now, let’s say our network can handle all the letters of the English alphabet, in both uppercase and lowercase, all the digits from 0-9, and a few special characters.</p>

<p>The following string has all the characters I will be using:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">validCharacters</span> <span class="o">=</span> 
        <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890\"\n',.?;()[]{}:!- "</span><span class="o">;</span></code></pre></figure>

<p>Our input and output layers must have one neuron for each character that’s present in the above string. As for the hidden layer, I’ll use 30 neurons. You are free to change that number.</p>

<p>To create an input LSTM layer with DL4J, you must use the <code class="highlighter-rouge">GravesLSTM</code> class. Similarly, to create an output RNN layer, you must use the <code class="highlighter-rouge">RnnOutputLayer</code> class. While creating these layers, you must remember to specify the activation functions they should use. For best results, using <code class="highlighter-rouge">TANH</code> for the input layer and <code class="highlighter-rouge">SOFTMAX</code> for the output layer is recommended.</p>

<p>Accordingly, add the following code:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">GravesLSTM</span><span class="o">.</span><span class="na">Builder</span> <span class="n">lstmBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GravesLSTM</span><span class="o">.</span><span class="na">Builder</span><span class="o">();</span>
<span class="n">lstmBuilder</span><span class="o">.</span><span class="na">activation</span><span class="o">(</span><span class="n">Activation</span><span class="o">.</span><span class="na">TANH</span><span class="o">);</span>
<span class="n">lstmBuilder</span><span class="o">.</span><span class="na">nIn</span><span class="o">(</span><span class="n">validCharacters</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
<span class="n">lstmBuilder</span><span class="o">.</span><span class="na">nOut</span><span class="o">(</span><span class="mi">30</span><span class="o">);</span> <span class="c1">// Hidden</span>
<span class="n">GravesLSTM</span> <span class="n">inputLayer</span> <span class="o">=</span> <span class="n">lstmBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">RnnOutputLayer</span><span class="o">.</span><span class="na">Builder</span> <span class="n">outputBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RnnOutputLayer</span><span class="o">.</span><span class="na">Builder</span><span class="o">();</span>
<span class="n">outputBuilder</span><span class="o">.</span><span class="na">lossFunction</span><span class="o">(</span><span class="n">LossFunctions</span><span class="o">.</span><span class="na">LossFunction</span><span class="o">.</span><span class="na">MSE</span><span class="o">);</span>
<span class="n">outputBuilder</span><span class="o">.</span><span class="na">activation</span><span class="o">(</span><span class="n">Activation</span><span class="o">.</span><span class="na">SOFTMAX</span><span class="o">);</span>
<span class="n">outputBuilder</span><span class="o">.</span><span class="na">nIn</span><span class="o">(</span><span class="mi">30</span><span class="o">);</span> <span class="c1">// Hidden</span>
<span class="n">outputBuilder</span><span class="o">.</span><span class="na">nOut</span><span class="o">(</span><span class="n">validCharacters</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
<span class="n">RnnOutputLayer</span> <span class="n">outputLayer</span> <span class="o">=</span> <span class="n">outputBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre></figure>

<p>Well, now that our neuron layers are ready, we can use them to create a <code class="highlighter-rouge">MultiLayerNetwork</code> object. You must, however, also create a <code class="highlighter-rouge">NeuralNetConfiguration.Builder</code> in order to configure the network. As always, during the configuration, you must specify details such as which optimization algorithm and updater to use, how to initialize the weights, and what the learning rate should be.</p>

<p>Here’s the configuration I used:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">NeuralNetConfiguration</span><span class="o">.</span><span class="na">Builder</span> <span class="n">nnBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NeuralNetConfiguration</span><span class="o">.</span><span class="na">Builder</span><span class="o">();</span>
<span class="n">nnBuilder</span><span class="o">.</span><span class="na">optimizationAlgo</span><span class="o">(</span><span class="n">OptimizationAlgorithm</span><span class="o">.</span><span class="na">STOCHASTIC_GRADIENT_DESCENT</span><span class="o">);</span>
<span class="n">nnBuilder</span><span class="o">.</span><span class="na">updater</span><span class="o">(</span><span class="n">Updater</span><span class="o">.</span><span class="na">ADAM</span><span class="o">);</span>
<span class="n">nnBuilder</span><span class="o">.</span><span class="na">weightInit</span><span class="o">(</span><span class="n">WeightInit</span><span class="o">.</span><span class="na">XAVIER</span><span class="o">);</span>
<span class="n">nnBuilder</span><span class="o">.</span><span class="na">learningRate</span><span class="o">(</span><span class="mf">0.01</span><span class="o">);</span>
<span class="n">nnBuilder</span><span class="o">.</span><span class="na">miniBatch</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

<span class="n">MultiLayerNetwork</span> <span class="n">network</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MultiLayerNetwork</span><span class="o">(</span>
            <span class="n">nnBuilder</span><span class="o">.</span><span class="na">list</span><span class="o">().</span><span class="na">layer</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">inputLayer</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">layer</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">outputLayer</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">backprop</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">pretrain</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">());</span>

<span class="n">network</span><span class="o">.</span><span class="na">init</span><span class="o">();</span></code></pre></figure>

<h3 id="create-training-data">Create Training Data</h3>

<p>As you might already know, DL4J expects you to place all your training data inside <code class="highlighter-rouge">INDArray</code> objects. That means, we must now create two <code class="highlighter-rouge">INDArray</code> objects: one for the input values and one for the expected output values, or labels.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>INDArray inputArray = Nd4j.zeros(1, inputLayer.getNIn(), inputData.length());
INDArray inputLabels = Nd4j.zeros(1, outputLayer.getNOut(), inputData.length());
</code></pre>
</div>

<p>While using an LSTM, the label for an input value is nothing but the next input value. For example, if your training data is the string “abc”, for the input value “a”, the label will be “b”. Similarly, for the input value “b”, the label will be “c”.</p>

<p>Keeping that in mind, you can populate the <code class="highlighter-rouge">INDArray</code> objects using the following code:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">inputData</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">positionInValidCharacters1</span> <span class="o">=</span> <span class="n">validCharacters</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">inputData</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
    <span class="n">inputArray</span><span class="o">.</span><span class="na">putScalar</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="mi">0</span><span class="o">,</span> <span class="n">positionInValidCharacters1</span><span class="o">,</span> <span class="n">i</span><span class="o">},</span> <span class="mi">1</span><span class="o">);</span>

    <span class="kt">int</span> <span class="n">positionInValidCharacters2</span> <span class="o">=</span> <span class="n">validCharacters</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">inputData</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">));</span>
    <span class="n">inputLabels</span><span class="o">.</span><span class="na">putScalar</span><span class="o">(</span><span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="mi">0</span><span class="o">,</span> <span class="n">positionInValidCharacters2</span><span class="o">,</span> <span class="n">i</span><span class="o">},</span> <span class="mi">1</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>Using the <code class="highlighter-rouge">INDArray</code> objects, you can now create a <code class="highlighter-rouge">DataSet</code> that can be directly used by your neural network.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">DataSet</span> <span class="n">dataSet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataSet</span><span class="o">(</span><span class="n">inputArray</span><span class="o">,</span> <span class="n">inputLabels</span><span class="o">);</span></code></pre></figure>

<h3 id="training-the-neural-network">Training the Neural Network</h3>

<p>At this point, all you need to do is call the <code class="highlighter-rouge">fit()</code> method and pass the data set to the neural network. However, trying to fit the data set just once is usually not enough. You must fit it several times before the neural network becomes accurate. I suggest you do it a thousand times at least.</p>

<p>Obviously, fitting the data a thousand times is going to take quite a long time. To be able to see the intermediate results the network generates for every iteration, you can pass test data to the network after each call to the <code class="highlighter-rouge">fit()</code> method.</p>

<p>The test data, of course, will be another <code class="highlighter-rouge">INDArray</code> object whose size is equal to the size of the network’s input layer. It will contain the index of just one character, which will also be the first character of the network’s generated text.</p>

<p>Using that character, our LSTM will generate a new character. By passing that generated character back to the LSTM as the next test data, you can generate another character. By repeating these steps again and again, you can generate strings that are arbitrarily long.</p>

<p>The following code shows you how to generate a string that’s 200 characters long for every iteration:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">z</span><span class="o">&lt;</span><span class="mi">1000</span><span class="o">;</span><span class="n">z</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">network</span><span class="o">.</span><span class="na">fit</span><span class="o">(</span><span class="n">dataSet</span><span class="o">);</span>

    <span class="n">INDArray</span> <span class="n">testInputArray</span> <span class="o">=</span> <span class="n">Nd4j</span><span class="o">.</span><span class="na">zeros</span><span class="o">(</span><span class="n">inputLayer</span><span class="o">.</span><span class="na">getNIn</span><span class="o">());</span>
    <span class="n">testInputArray</span><span class="o">.</span><span class="na">putScalar</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>

    <span class="n">network</span><span class="o">.</span><span class="na">rnnClearPreviousState</span><span class="o">();</span>
    <span class="n">String</span> <span class="n">output</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">INDArray</span> <span class="n">outputArray</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="na">rnnTimeStep</span><span class="o">(</span><span class="n">testInputArray</span><span class="o">);</span>
        <span class="kt">double</span> <span class="n">maxPrediction</span> <span class="o">=</span> <span class="n">Double</span><span class="o">.</span><span class="na">MIN_VALUE</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">maxPredictionIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">validCharacters</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">maxPrediction</span> <span class="o">&lt;</span> <span class="n">outputArray</span><span class="o">.</span><span class="na">getDouble</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">maxPrediction</span> <span class="o">=</span> <span class="n">outputArray</span><span class="o">.</span><span class="na">getDouble</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="n">maxPredictionIndex</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="c1">// Concatenate generated character</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">validCharacters</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">maxPredictionIndex</span><span class="o">);</span>
        <span class="n">testInputArray</span> <span class="o">=</span> <span class="n">Nd4j</span><span class="o">.</span><span class="na">zeros</span><span class="o">(</span><span class="n">inputLayer</span><span class="o">.</span><span class="na">getNIn</span><span class="o">());</span>
        <span class="n">testInputArray</span><span class="o">.</span><span class="na">putScalar</span><span class="o">(</span><span class="n">maxPredictionIndex</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">z</span> <span class="o">+</span> <span class="s">" &gt; A"</span> <span class="o">+</span> <span class="n">output</span> <span class="o">+</span> <span class="s">"\n----------\n"</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>As you can see in the above code, we are finding the output neuron with the highest value and using it to determine the next character. Also note that you must always remember to call the <code class="highlighter-rouge">rnnClearPreviousState()</code> method in every iteration.</p>

<p>And that’s all there is to creating an LSTM. Go ahead and run the program to see it generate sentences and paragraphs that are eerily similar to valid English prose.</p>

<p>Here are some paragraphs my LSTM generated after being trained for nearly an hour:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># At iteration 400</span>
At as tebeer spws sowingg yeay ans tulm uulmr, and ane smel-nolng one loomyeang one loo loon one loor and the Harlond mayeld hat could make
the far-lnold years cfer
he s had make
so furils of the reang

<span class="c"># At iteration 600</span>
At arss the sof mangsming dayd anys civme dard any of
the darmyeand coumy on ofeendmeeand fol of
the dere deing wmilendewe of
ftw ongling going of Haknf
the farm-loket could have wondeere thamen-folk f

<span class="c"># At iteration 800</span>
At arslas going gayeads sfmiry as after s fmeras and anys names and song and anlmaso off
the ands of
thad soingl, soing amelas of
the formesars civil were of
England, and noul Haaldeha have wondered it

<span class="c"># At iteration 1000</span>
As was sweet spring yaays summer, and any one of Hayslope any one sumirer all seee lone loo long, now so full of the promise of earl that the farm could have wondered smiling England of farm-labourers</code></pre></figure>

<p>As you can see, the paragraphs still contain quite a lot of jibberish. By increasing the number of iterations, and by using more of the novel, you can get better results.</p>

<h3 id="conclusion">Conclusion</h3>

<p>You now know how to create a simple LSTM using DeepLearning4J. Although we created a character-based LSTM, it is possible to create LSTMs that are word based, which will generate sentences that are more natural. Doing so, however, would definitely be slightly more complex.</p>

<h4 id="related-reading">Related Reading</h4>

<ul>
  <li><a href="/2017/01/how-to-use-deeplearning4j-on-android.html">How to Use Deeplearning4J in Android Apps</a></li>
  <li><a href="/2016/09/how-to-create-and-use-neural-networks-in-javascript.html">How to Create Simple Neural Networks in JavaScript</a></li>
  <li><a href="/2016/09/how-to-create-deep-neural-networks-in-javascript.html">How to Create Deep Neural Networks in JavaScript</a></li>
</ul>

                    </div>

                    <!-- Affiliate links -->
                    <div class="post-affiliates">
                        <script type="text/javascript">
                        amzn_assoc_placement = "adunit0";
                        amzn_assoc_search_bar = "true";
                        amzn_assoc_tracking_id = "progur-20";
                        amzn_assoc_ad_mode = "manual";
                        amzn_assoc_ad_type = "smart";
                        amzn_assoc_marketplace = "amazon";
                        amzn_assoc_region = "US";
                        amzn_assoc_title = "Shop Related Products";
                        amzn_assoc_linkid = "6b7650e384633c5d230f7dd85c971ee5";
                        amzn_assoc_asins = "B071VLZ9ZK,B01J6G4WB6,B00C893P8U,B00P8DRZWA,B01MRZFBBH,B01MXLZIDS,B01H3V07EW,B00LEAPLWW";
                        </script>
                        <script src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US"></script>
                    </div>
                    <!-- End of affiliate links -->

                    <!-- Share -->
                    <div class="post-share">
                        <p>If you found this article useful, please share it with your friends and colleagues!</p>
                        <a class="btn btn-primary" style="background:#4099FF" target="_blank" href="https://twitter.com/intent/tweet?text=How to Create an LSTM Recurrent Neural Network Using DL4J&url=http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html&via=hathibel" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-twitter fa-lg"></i></a>

                        <a class="btn btn-primary" style="background:#3b5998" target="_blank" href="https://facebook.com/sharer.php?u=http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-facebook fa-lg"></i></a>
                        
                        <a class="btn btn-primary" style="background:#dd4b39" target="_blank" href="https://plus.google.com/share?url=http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i class="fa fa-google-plus fa-lg"></i></a>
                    </div>

                    <!-- End of Share -->

                    <!-- Comments -->
                      <div class="comments">
                          <div id="disqus_thread"></div>
                            <script>                                    
                                var disqus_config = function () {
                                    this.page.url = "http://progur.com/2017/06/how-to-create-lstm-rnn-deeplearning4j.html";
                                    this.page.identifier = "/2017/06/how-to-create-lstm-rnn-deeplearning4j.html";
                                };
                                (function() {
                                    var d = document, s = d.createElement('script');

                                    s.src = '//progur.disqus.com/embed.js';

                                    s.setAttribute('data-timestamp', +new Date());
                                    (d.head || d.body).appendChild(s);
                                })();
                            </script>
                            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                      </div>
                    <!-- End of comments -->
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="footer">
  <div class="container">
    <p>
        Copyright &copy; 2016-2017 Progur.com | All rights reserved.
        <br/>
        Powered by Jekyll, and several secret sauces.
    </p>
  </div>
</footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shAutoloader.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushBash.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJava.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPython.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushRuby.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCpp.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.min.js"></script>

          <script>
              SyntaxHighlighter.defaults.toolbar = false;
              SyntaxHighlighter.all();
          </script>

        <!-- Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-46644689-5', 'auto');
          ga('send', 'pageview');

        </script>
        <!-- End of Analytics -->

  </body>
</html>

