<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">        

    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeEclipse.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreEclipse.min.css">

    <link href="/css/custom.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Begin Jekyll SEO tag v2.0.0 -->
<title>How to Create Deep Neural Networks in JavaScript - Progur!</title>
<meta property="og:title" content="How to Create Deep Neural Networks in JavaScript" />
<meta name="description" content="In this tutorial, you’re going to learn how to use JavaScript and Synaptic to create, train, and use deep neural networks that have several hidden layers." />
<meta property="og:description" content="In this tutorial, you’re going to learn how to use JavaScript and Synaptic to create, train, and use deep neural networks that have several hidden layers." />
<link rel="canonical" href="http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html" />
<meta property="og:url" content="http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html" />
<meta property="og:site_name" content="Progur!" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-09-07T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@hathibel" />
<meta name="twitter:creator" content="@hathibel" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "How to Create Deep Neural Networks in JavaScript",
    "datePublished": "2016-09-07T00:00:00+05:30",
    "description": "In this tutorial, you’re going to learn how to use JavaScript and Synaptic to create, train, and use deep neural networks that have several hidden layers.",
    "logo": "http://progur.com/assets/logo.jpg",
    "url": "http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html"
  }
</script>
<!-- End Jekyll SEO tag -->
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><i class="fa fa-terminal logo"></i> PROGUR!</a>
        </div>
        <!-- Options -->
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a target="_blank" href="https://twitter.com/hathibel" title="Follow me on Twitter"><i class="fa fa-lg fa-twitter" style="color: #4099FF"></i> &nbsp; Twitter</a></li>
            <li><a target="_blank" href="https://plus.google.com/+Progur" title="Follow me on Google+" ><i class="fa fa-lg fa-google-plus" style="color: #d34836"></i> &nbsp; Google+</a></li>
            <li><a target="_blank" href="https://github.com/hathibelagal" title="Follow me on GitHub"><i class="fa fa-lg fa-github" style="color: #999999"></i> &nbsp; GitHub</a></li>
            <li><a target="_blank" href="https://medium.com/@hathibel" title="Follow me on Medium"><i class="fa fa-lg fa-medium" style="color: #0be370"></i> &nbsp; Medium</a></li>
            <li><a target="_blank" href="/feed.xml" title="Subscribe to our RSS feed"><i class="fa fa-lg fa-rss" style="color: #FF6600"></i>&nbsp; RSS</a></li>
          </ul>
        </div>
        <!-- End of Options -->
      </div>
    </nav>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div>
                <div>
                    <h1 class="post-title">How to Create Deep Neural Networks in JavaScript</h1>
                    <div class="post-meta">Written by Ashraff Hathibelagal &bull; 07 September 2016</div>
                    <p style="margin-bottom: 20px"><span class="label label-info"><i class="fa fa-tag"> </i> &nbsp; Programming </span></p>
                    <div class="post-actual-content">
                        <p>In my <a href="/2016/09/how-to-create-and-use-neural-networks-in-javascript.html">previous post</a>, I showed you how to create a simple neural network that has only an input layer, and an output layer. By adding a few hidden layers between the input and output layers, you can create a deep neural network. Deep neural networks are usually far more powerful, and are capable of both supervised and unsupervised learning. In this tutorial, I’ll show you how to create a deep neural network with two hidden layers, and use it to perform yet another rather trivial task: decide what I should wear based on the temperature.</p>

<h3 id="creating-the-deep-neural-network">Creating the Deep Neural Network</h3>

<p>So, this time, I want to build a neural network that can take the temperature in Celsius as an input, and tell me what I should be wearing. Here’s the algorithm it should follow:</p>

<pre class="brush: ruby">
if TEMPERATURE &lt;= 5°C
    Suggest THICK JACKET

if TEMPERATURE &gt; 5°C and TEMPERATURE &lt;= 15°C
    Suggest SWEATER

if TEMPERATURE &gt; 15°C and TEMPERATURE &lt;= 40°C
    Suggest T-SHIRT

if TEMPERATURE &gt; 40°C
    Suggest NOTHING 
</pre>

<p>Now, you might be thinking we can simply use one neuron in the input layer for the temperature. Well, you can, however, your neural network’s accuracy would then be rather low. In this tutorial, we’re going to convert the temperature into a 7-digit binary form, and use seven neurons for the input layer.</p>

<p>You can use the following function to do the conversion:</p>

<pre class="brush: javascript">
function convertToBinaryArray(temperature) {
    var tempInBinary = temperature.toString(2); // Convert to binary

    // If it is more than 7 digits long, truncate
    if(tempInBinary.length &gt; 7)
        return [1,1,1,1,1,1,1];

    // If it less than 7 digits long, add zeroes
    while(tempInBinary.length &lt; 7) { 
        tempInBinary = "0" + tempInBinary;
    }

    // Convert string to array
    return tempInBinary.split("").map(function(i) {
        return parseInt(i); }
    );
}
</pre>

<p><em>Feel free to modify the function if you think you can make it shorter or more readable!</em></p>

<p>As for the output layer, four neurons will be enough(THICK JACKET, SWEATER, T-SHIRT, NOTHING). Additionally, we shall have 2 hidden layers with three neurons each.</p>

<p>Although you can create the layers individually, and connect them, Synaptic offers a class called <code class="highlighter-rouge">synaptic.Architect.Perceptron</code> that lets you build complex networks in just a few seconds. Here’s how you can use <code class="highlighter-rouge">synaptic.Architect.Perceptron</code> to create the deep neural network:</p>

<pre class="brush: javascript">
var myDeepNetwork = new synaptic.Architect.Perceptron(
    7, // Input layer with 7 neurons
    3, // First hidden layer with 3 neurons
    3, // Second hidden layer with 3 neurons
    4 // Output layer with 4 neurons
);
</pre>

<p>Our neural network is now ready!</p>

<p><em>If you want to, you can also call this deep neural network a <strong>Multi-Layer Perceptron(MLP)</strong>.</em></p>

<h3 id="creating-the-training-data">Creating the Training Data</h3>

<p>We can now create a loop to generate our training data.</p>

<pre class="brush: javascript">
var trainingData = [];

for(var i = 1;i &lt; 75; i++) {
    var input = convertToBinaryArray(i); // Input layer
    var output = [0,0,0,0]; // Undecided state of output layer

    if(i &lt;= 5)
        output = [1,0,0,0]; // THICK JACKET
    else if(i &gt; 5 &amp;&amp; i &lt;= 15)
        output = [0,1,0,0]; // SWEATER
    else if(i &gt; 15 &amp;&amp; i &lt;= 40)
        output = [0,0,1,0]; // T-SHIRT
    else
        output = [0,0,0,1]; // NOTHING

    trainingData.push({
        input: input,
        output: output
    });
}
</pre>

<p><em>Note that in the real world, you would not have to write any code to generate the data. You would simply pick the data up from somewhere. You would, however, still have to write code to convert it into input and output arrays.</em></p>

<h3 id="training-the-neural-network">Training the Neural Network</h3>

<p>Synaptic has a class called <code class="highlighter-rouge">synaptic.Trainer</code> that allows you to train your neural network using just one method called <code class="highlighter-rouge">train()</code>. Let’s use that now.</p>

<pre class="brush: javascript">
var myTrainer = new synaptic.Trainer(myDeepNetwork); // Create trainer
myTrainer.train(trainingData, {
    rate: 0.1,
    iterations: 10000,
    shuffle: true
}); // Train with training data
</pre>

<p>As you can see, you can pass the learning rate, number of iterations and other configurations details directly to the <code class="highlighter-rouge">train()</code> method.</p>

<h3 id="using-the-neural-network">Using the Neural Network</h3>

<p>Our neural network is trained and ready to be used. Let’s call its <code class="highlighter-rouge">activate()</code> method for the temperature 11°C, and see what it recommends.</p>

<pre class="brush: javascript">
var cTemp = convertToBinaryArray(11);
var recommendations = myDeepNetwork.activate(cTemp);

// Log neuron outputs
console.log("THICK JACKET neuron: " + (recommendations[0] * 100) + "%");
console.log("SWEATER neuron: " + (recommendations[1] * 100) + "%");
console.log("T-SHIRT neuron: " + (recommendations[2] * 100) + "%");
console.log("NOTHING neuron: " + (recommendations[3] * 100) + "%");
</pre>

<p>Here’s the output I got:</p>

<pre class="brush: bash">
THICK JACKET neuron: 1.187852121842318%
SWEATER neuron: 99.04285103672623%
T-SHIRT neuron: 0.19623392618093957%
NOTHING neuron: 0.2812308783464911%
</pre>

<p>As you can see, for 11°C, the SWEATER neuron is firing with a value of &gt;99%, while all other neurons have a value of less than 2%.</p>

<p>Let us now see what it says for 32°C.</p>

<pre class="brush: bash">
THICK JACKET neuron: 0.5111861782203928%
SWEATER neuron: 0.00020342986269563567%
T-SHIRT neuron: 87.58129843432297%
NOTHING neuron: 0.17906434966864235%
</pre>

<p>The neural network has the right answer again. This time, the T-SHIRT neuron is firing with the highest value.</p>

<p>What about a border condition, like 5°C.</p>

<pre class="brush: bash">
THICK JACKET neuron: 71.57886740905687%
SWEATER neuron: 19.97632896204967%
T-SHIRT neuron: 0.5732055868587239%
NOTHING neuron: 0.044105602954815616%
</pre>

<p>The neural network now shows a value of 71% for THICK JACKET and ~20% for SWEATER. Nevertheless, because THICK JACKET has the highest value, it is still correct.</p>

<h3 id="conclusion">Conclusion</h3>

<p>You now know how to construct and use deep neural networks. Feel free to experiment with different values for the learning rates, number of hidden layers, and other such configurations details of the neural network.</p>

<h4 id="related-reading">Related Reading</h4>

<ul>
  <li><a href="/2016/09/how-to-create-and-use-neural-networks-in-javascript.html">How to Create Simple Neural Networks in JavaScript</a></li>
</ul>

                    </div>

                    <!-- Share -->
                    <div class="post-share">
                        <p>If you found this article useful, please share it with your friends and colleagues!</p>
                        <a class="btn btn-primary" style="background:#4099FF" target="_blank" href="https://twitter.com/intent/tweet?text=How to Create Deep Neural Networks in JavaScript&url=http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html&via=hathibel" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-twitter fa-lg"></i></a>

                        <a class="btn btn-primary" style="background:#3b5998" target="_blank" href="https://facebook.com/sharer.php?u=http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600');return false;"><i class="fa fa-facebook fa-lg"></i></a>
                        
                        <a class="btn btn-primary" style="background:#dd4b39" target="_blank" href="https://plus.google.com/share?url=http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"><i class="fa fa-google-plus fa-lg"></i></a>
                    </div>

                    <!-- End of Share -->

                    <!-- Comments -->
                      <div class="comments">
                          <div id="disqus_thread"></div>
                            <script>                                    
                                var disqus_config = function () {
                                    this.page.url = "http://progur.com/2016/09/how-to-create-deep-neural-networks-in-javascript.html";
                                    this.page.identifier = "/2016/09/how-to-create-deep-neural-networks-in-javascript.html";
                                };
                                (function() {
                                    var d = document, s = d.createElement('script');

                                    s.src = '//progur.disqus.com/embed.js';

                                    s.setAttribute('data-timestamp', +new Date());
                                    (d.head || d.body).appendChild(s);
                                })();
                            </script>
                            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                      </div>
                    <!-- End of comments -->
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="footer">
  <div class="container">
    <p>
        Copyright &copy; 2016-2017 Progur.com | All rights reserved.
        <br/>
        Powered by Jekyll, and several secret sauces.
    </p>
  </div>
</footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shAutoloader.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushBash.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJava.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPython.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushRuby.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCpp.min.js"></script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushJScript.min.js"></script>

          <script>
              SyntaxHighlighter.defaults.toolbar = false;
              SyntaxHighlighter.all();
          </script>

        <!-- Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-46644689-5', 'auto');
          ga('send', 'pageview');

        </script>
        <!-- End of Analytics -->

  </body>
</html>

